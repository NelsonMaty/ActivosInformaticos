

<div id="win" layout="column" style=" height: 100%;" ng-click="clickClose(); clickRelacionClose();">
  <md-toolbar layout="row" >
    <div class="md-toolbar-tools" >

      <h1>Activos Informaticos &nbsp; </h1>
      <div ng-show="clicked" class="cerrar-menu-activo" ng-class="{'mostrar-menu-activo animated bounceInLeft': clicked }">

            <md-button aria-label="Abrir" class="md-icon-button" ng-click="goAsset($event, clicked_asset, clicked_index); $event.stopPropagation();">
              <md-tooltip md-direction="bottom"> Ver </md-tooltip>
              <md-icon md-font-set="material-icons">visibility</md-icon>
            </md-button>
            <md-button aria-label="Editar"  class="md-icon-button" ng-click="editAsset($event, clicked_asset, clicked_index); $event.stopPropagation();">
              <md-tooltip md-direction="bottom"> Editar </md-tooltip>
              <md-icon md-font-set="material-icons">edit</md-icon>
            </md-button>
            <md-button aria-label="Borrar"  class="md-icon-button"ng-click="deleteAsset($event, clicked_asset, clicked_index); $event.stopPropagation();">
              <md-tooltip md-direction="bottom"> Borrar </md-tooltip>
              <md-icon md-font-set="material-icons">delete</md-icon>
            </md-button>
            <md-button aria-label="Relacionar" class="md-icon-button" ng-click="addRelation($event,'3', clicked_asset); $event.stopPropagation();">
              <md-tooltip md-direction="bottom"> Relacionar </md-tooltip>
              <md-icon md-font-set="material-icons">link</md-icon>
            </md-button>
      </div>
      <div ng-show="clickedR" class="cerrar-menu-activo" ng-class="{'mostrar-menu-activo animated bounceInLeft': clickedR }">

            <md-button aria-label="Abrir" class="md-icon-button" ng-click="goRelation($event, clicked_relation, clicked_RelationIndex); $event.stopPropagation();">
              <md-tooltip md-direction="bottom"> Ver </md-tooltip>
              <md-icon md-font-set="material-icons">visibility</md-icon>
            </md-button>
            <md-button aria-label="Editar"  class="md-icon-button" ng-click="editRelation($event, clicked_relation, clicked_RelationIndex); $event.stopPropagation();">
              <md-tooltip md-direction="bottom"> Editar </md-tooltip>
              <md-icon md-font-set="material-icons">edit</md-icon>
            </md-button>
            <md-button aria-label="Borrar"  class="md-icon-button"ng-click="deleteRelation($event, clicked_relation, clicked_RelationIndex, select_asset._id); $event.stopPropagation();">
              <md-tooltip md-direction="bottom"> Borrar </md-tooltip>
              <md-icon md-font-set="material-icons">delete</md-icon>
            </md-button>

      </div>
      <span flex=""></span>
      <!-- <md-button class="md-icon-button" aria-label="Busqueda">
        <md-icon md-font-set="material-icons">search</md-icon>
      </md-button> -->

      <md-menu md-position-mode="target-right target">
        <md-button class="md-icon-button" aria-label="Opciones" ng-click="openMenu($mdOpenMenu, $event)">
          <md-icon md-menu-origin="" md-font-set="material-icons">settings</md-icon>
        </md-button>

        <md-menu-content width="1">
          <md-menu-item>
            <md-button ng-click="go('/admin')">
              <md-icon md-font-set="material-icons" md-menu-align-target="" >face</md-icon>
              Administrar usuarios
            </md-button>
          </md-menu-item>


        </md-menu-content>

      </md-menu>
    </div>
  </md-toolbar>
  <div layout="row" flex>
    <!-- <md-sidenav layout="column" class="md-sidenav-left md-whiteframe-4dp" md-component-id="left" md-is-locked-open="$mdMedia('gt-sm')">
      <md-button class="md-accent">Mis activos</md-button>
      <md-button class="md-accent">Compartidos</md-button>
    </md-sidenav> -->
    <div layout="column" flex id="content">
      <md-content layout="column" flex class="md-padding" layout="column" flex="100">

          <md-content layout="column" flex="100">
            <md-tabs md-border-bottom="" layout="column" flex="100">

              <md-tab label="Activos">
                <md-content class="md-padding">
                  <h1 class="md-display-2">Todos los activos</h1>

                  <div layout="row" layout-wrap layout-margin layout-align="start center" >

                    <!--div style="min-width: 15%; cursor:pointer; cursor: hand" layout="column" layout-align="center" ng-repeat="asset in myassets" ng-click="goAsset($event, asset, $index)"-->
                    <div style="min-width: 15%; cursor:pointer; cursor: hand" layout="column" layout-align="center" ng-repeat="asset in myassets" ng-click="clickAsset(asset, $index);  $event.stopPropagation();" ng-dblclick="goAsset($event, clicked_asset, clicked_index)">
                             <!--img src="images/nota.svg"/-->
                      <md-icon style="font-size: 48px; width: 50px;height: 50px;" ng-class="{'select-activo animated pulse': clickedIcon($index) }"  md-font-set="material-icons">description</md-icon>
                      <div style="text-align: center"> {{asset.name}} </div>
                    </div>
                  </div>

                </md-content>
              </md-tab>

              <md-tab label="Relaciones">
                <div >
                  <div layout="column">
                    <div layout="row" layout-align="space-between center" style="padding-top:20px;">
                      <h1 class="md-display-2" ng-show="!direccionRelaciones">Relaciones salientes</h1>
                      <h1 class="md-display-2" ng-show="direccionRelaciones">Relaciones entrantes</h1>
                      <md-input-container style="margin-top:0px; margin-bottom:0px; top:8px; padding-right:36px; width:280px;">
                        <!-- <md-switch ng-model="direccionRelaciones" ng-change="searchRelations(select_asset._id,select_asset.name)">Relaciones salientes/entrantes</md-switch> -->
                        <label>Filtro de relaciones</label>
                        <md-icon md-font-set="material-icons" >filter_list</md-icon>
                        <md-select ng-model="direccionRelaciones" aria-label="filtro relaciones" md-on-close="searchRelations(select_asset._id,select_asset.name)">
                          <md-option ng-repeat="filtro in filtros" value="{{filtro}}" >
                              {{filtro}}
                          </md-option>
                        </md-select>
                      </md-input-container>
                    </div>

                  </div>

                  <p style="margin-top:20px; margin-bottom:20px;"> Seleccione un activo de la lista para ver las relaciones en las que participa </p>
                  <div layout="column">
                    <div layout="row" style="min-height: 600px;">

                      <md-sidenav class="md-sidenav-left " md-component-id="left" md-is-locked-open="$mdMedia('gt-sm')" style="min-width: 25% !important; width: 700px; ">
                        <md-input-container class="md-icon-float md-block" style="top: 20px;">
                          <input type="search" ng-model="buscado" placeholder="Activos" aria-label="filter assets" />
                        </md-input-container>
                        <md-list ng-cloak>

                          <md-list-item ng-repeat="asset in myassets | filter:buscado" ng-click="searchRelations(asset._id,asset.name)" ng-class="{'select-activo animated pulse': clickedIcon($index) }">


                            <p>{{ asset.name }}</p>

                            <md-divider ng-if="!$last"></md-divider>
                          </md-list-item>
                        </md-list>
                      </md-sidenav>

                      <div layout="column" flex id="content" style="width: 1000px; " >
                        <div layout="row" layout-wrap layout-margin layout-align="start center" style="margin-left:20px; " >

                          <!--div style="min-width: 15%; cursor:pointer; cursor: hand" layout="column" layout-align="center" ng-repeat="asset in myassets" ng-click="goAsset($event, asset, $index)"-->
                          <div style="min-width: 15%; cursor:pointer; cursor: hand" layout="column" layout-align="center" ng-repeat="relation in assetRelations" ng-click="clickRelation(relation, $index);  $event.stopPropagation();" ng-dblclick="goRelation($event, relation, sourceAssetId, $index)">
                            <md-icon style="font-size: 48px; width: 50px;height: 50px;" ng-class="{'select-relacion animated pulse': clickedRelacionIcon($index) }"  md-font-set="material-icons">link</md-icon>
                            <div style="text-align: center" ng-show="!direccionRelaciones"> {{labels[$index].outLabel || relation.relationTypeId }} </div>
                            <div style="text-align: center" ng-show="direccionRelaciones"> {{labels[$index].inLabel || relation.relationTypeId }} </div>
                          </div>
                        </div>
                      </div>

                    </div>
                  </div>

                </div>
              </md-tab>
              <md-tab label="Mapa">
                <md-content class="md-padding">
                  <h1 class="md-display-2">Mapa de relaciones</h1>

                  <p style="margin-top:20px; margin-bottom:20px;"> Seleccione un activo de la lista para ver las relaciones en las que participa </p>
                  <div layout="row" flex>
                    <md-sidenav layout="column" class="md-sidenav-left " md-component-id="left" md-is-locked-open="$mdMedia('gt-sm')" style="min-width: 25% !important;">
                      <md-input-container class="md-icon-float md-block" style="top: 20px;">
                        <input type="search" ng-model="buscado" placeholder="Activos" aria-label="filter" />
                      </md-input-container>
                      <md-list ng-cloak>

                        <md-list-item ng-repeat="asset in myassets | filter:buscado" ng-click="goToMap(asset,$index)" ng-class="{'select-activo animated pulse': clickedIcon($index) }">

                          <p>{{ asset.name }}</p>

                          <md-divider ng-if="!$last"></md-divider>
                        </md-list-item>
                      </md-list>
                    </md-sidenav>
                    <div class="" flex>

                      <div class="" layout-align="end end" layout="row" style="">
                        <md-input-container class="" ng-show="svgExist" style="margin-bottom:0px;height:40px;">

                          <input id="search" ng-model="buscado2" type="text" placeholder="Ingrese nombre de activo" >
                        </md-input-container>

                        <!-- < <input id="search"> -->
                        <md-button type="button" style="margin-bottom:0px;" ng-show="svgExist" ng-click="searchNode()">Buscar</md-button>
                      </div>
                      <div id="relGraph">

                      </div>

                    </div>

                  </div>
                </md-content>
              </md-tab>
              <md-tab label="Buscador" style="height:100%;">
                <div layout="column" flex="100">

                <div layout="row" layout-align="space-between center">

                  <div flex>

                    <md-content class="md-padding" layout="row" flex="100">
                      <div layout="column" style="width: 100%;">
                        <div flex layout="row" layout-align="space-between top">
                          <h1 class="md-display-2" >Buscador de activos</h1>
                          <md-input-container style="margin-top:0px;">
                            <md-switch ng-click="toggleRight()" ng-model="busquedaAvanzada">Busqueda avanzada</md-switch>
                          </md-input-container>
                        </div>
                        <div class="" layout="row" layout-align="space-between center ">
                          <div layout="row" >
                            <md-input-container class=" md-block" style="width: 400px;">
                              <md-icon md-font-set="material-icons" aria-label="nombre tipo activo">search</md-icon>
                              <input ng-model="buscadoString" type="text" placeholder="Ingrese valor a buscar" ng-disabled="busquedaAvanzada">
                            </md-input-container>
                            <div class="">
                              <md-button ng-click="busqueda(buscadoString)" ng-disabled="busquedaAvanzada">
                                Buscar
                              </md-button>
                            </div>
                          </div>
                        </div>
                        <md-divider></md-divider>
                        <h1 class="md-display-1" style="padding-top:20px;">Resultados</h1>
                        <p class="md-block" ng-if="resultadoBusqueda.length==0 " style="margin-top:20px; margin-bottom:20px; padding-left:35px; padding-top:20px;"> No se encontraron resultados </p>

                        <div layout="row" layout-sm="column" layout-align="space-around" ng-if="buscando" >
                          <md-progress-circular md-mode="indeterminate" md-diameter="106"></md-progress-circular>
                        </div>

                        <md-list ng-if="!buscando" ng-cloak>
                          <md-list-item ng-repeat="resultado in resultadoBusqueda" ng-click="goAsset($event,resultado,indicesBusqueda[$index],$index)">
                            <md-icon md-font-set="material-icons">receipt</md-icon>

                            <p>{{ resultado.name }}</p>

                            <md-divider ng-if="!$last"></md-divider>
                          </md-list-item>
                        </md-list>

                      </div>
                    </md-content>
                  </div>
                  <div >
                  <md-sidenav  class="md-sidenav-right md-whiteframe-4dp" md-component-id="right"  md-disable-backdrop >
                    <md-toolbar class="md-theme-light" layout="row">
                      <h1 class="md-toolbar-tools">Busqueda Avanzada</h1>
                      <md-button class="md-icon-button" style="top: 7px;" ng-click="cerrarAvanzado()">
                  	    <md-icon md-font-set="material-icons" aria-label="Close dialog">close</md-icon>
                  	  </md-button>
                    </md-toolbar>
                    <md-content layout-padding="">
                      <form ng-switch="opcionBusqueda">
                        <span flex></span>
                        <div ng-switch-when="tipo">
                          <md-input-container >
                            <md-icon md-font-set="material-icons" aria-label="nombre tipo activo">search</md-icon>
                            <input type="text" ng-model="$parent.buscadoTipo"  placeholder="Ingrese tipo de activo">
                          </md-input-container>
                          <md-input-container >
                            <md-icon md-font-set="material-icons" aria-label="valor buscado activo">search</md-icon>
                            <input ng-model="$parent.buscadoString" type="text" placeholder="Ingrese valor a buscar">
                          </md-input-container>
                        </div>
                        <div ng-switch-when="params" >
                          <md-input-container style="margin-bottom:38px;">
                            <label>Tipo de activo</label>
                            <md-icon md-font-set="material-icons" >receipt</md-icon>
                            <md-select ng-model="$parent.selectedType" aria-label="nombre nodos" md-on-close="listarAtributos()">
                              <md-option ng-repeat="tipo in assettypes" value="{{tipo._id}}" >
                                  Tipo de activo {{tipo.name}}
                              </md-option>
                            </md-select>
                          </md-input-container>
                          <md-input-container style="width:236px;">
                            <label>Atributo a buscar</label>
                            <md-icon md-font-set="material-icons" aria-label="seleccion atributo">settings_input_component</md-icon>
                            <!-- <input type="text" ng-model="$parent.buscadoAtributo"placeholder="Ingrese nombre de atributo"> -->
                            <md-select ng-model="$parent.buscadoAtributo" aria-label="nombre atributo" ng-disabled="!$parent.selectedType">
                              <md-option ng-repeat="atributo in $parent.listaAtrib" value="{{atributo.valor}}" >
                                  {{atributo.texto}}
                              </md-option>
                            </md-select>
                          </md-input-container>
                          <md-input-container >
                            <md-icon md-font-set="material-icons" aria-label="valor">search</md-icon>
                            <input type="text" ng-model="$parent.buscadoValor" placeholder="Ingrese valor de atributo" ng-disabled="!$parent.buscadoAtributo">
                          </md-input-container>

                        </div>

                      </form>
                       <div class="" layout="column">
                          <div layout="row" ng-show="busquedaAvanzada">
                            <div >
                              <md-radio-group ng-model="opcionBusqueda">
                                <md-radio-button value="tipo">Tipo de activo</md-radio-button>
                                <md-radio-button value="params">Parametrizada</md-radio-button>
                              </md-radio-group>
                            </div>

                          </div>

                        </div>

                      <md-button ng-click="busqueda(buscadoString,buscadoTipo)" ng-if="opcionBusqueda=='tipo'" class="md-primary">
                        Buscar
                      </md-button>
                      <md-button ng-click="busqueda(buscadoString,buscadoTipo,buscadoAtributo,buscadoValor,'params')" ng-if="opcionBusqueda=='params'" class="md-primary" ng-disabled="!$parent.buscadoAtributo">
                        Buscar
                      </md-button>

                    </md-content>
                  </md-sidenav>
                  </div>
                </div>
                </div>
              </md-tab>
            </md-tabs>
          </md-content>
        </div>

      </md-content>

      <ul mfb-menu menu-state="myVar" position="br" effect="slidein" active-icon="ion-close" resting-icon="ion-plus" toggling-method="click" >
        <!--a mfb-button mfb-button-close icon="ion-android-list" label="Nuevo tipo de activo" ng-click="showAddAssetType($event)" >  </a-->
        <a mfb-button mfb-button-close icon="ion-link" label="Nueva relacion" ng-click="addRelation($event,'1',null)" >  </a>
        <a mfb-button mfb-button-close icon="ion-ios-paper" label="Nuevo activo" ng-click="showAddAsset($event)" >  </a>
      </ul>

  </div>
  <!-- Angular Material Dependencies -->

</div>
